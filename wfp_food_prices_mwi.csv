# ---------------- FULL EMBEDDED CSV (2021â€“2025) ----------------
EMBEDDED_CSV_DATA = """date,admin1,admin2,market,market_id,latitude,longitude,category,commodity,commodity_id,unit,priceflag,pricetype,currency,price,usdprice
2021-01-15,Central Region,Kasungu,Kasungu,2008,-13.03,33.48,"tobacco","Tobacco (Virginia)",701,KG,actual,Wholesale,MWK,6100,7.44
2021-01-15,Central Region,Kasungu,Kasungu,2008,-13.03,33.48,"tobacco","Tobacco (Burley)",702,KG,actual,Wholesale,MWK,5800,7.07
2021-01-15,Central Region,Mchinji,Mchinji,2010,-13.80,32.90,"tobacco","Tobacco (Oriental)",703,KG,actual,Wholesale,MWK,5200,6.34
2021-01-15,Southern Region,Thyolo,Thyolo,2120,-16.07,35.14,"tea","Tea (black)",702,KG,actual,Wholesale,MWK,3000,3.66
2021-01-15,Southern Region,Mulanje,Mulanje,2115,-16.03,35.50,"coffee","Coffee (arabica)",703,KG,actual,Wholesale,MWK,5100,6.22
2021-01-15,Central Region,Dowa,Dowa,2007,-13.65,34.30,"pulses and nuts","Beans (red)",68,KG,actual,Retail,MWK,2500,3.05
2021-01-15,Central Region,Dowa,Dowa,2007,-13.65,34.30,"pulses and nuts","Groundnuts (unshelled)",69,KG,actual,Retail,MWK,1500,1.83
2021-02-15,Central Region,Kasungu,Kasungu,2008,-13.03,33.48,"tobacco","Tobacco (Virginia)",701,KG,actual,Wholesale,MWK,6150,7.50
2021-02-15,Central Region,Kasungu,Kasungu,2008,-13.03,33.48,"tobacco","Tobacco (Burley)",702,KG,actual,Wholesale,MWK,5850,7.13
2021-02-15,Southern Region,Thyolo,Thyolo,2120,-16.07,35.14,"tea","Tea (black)",702,KG,actual,Wholesale,MWK,3020,3.68
2021-02-15,Southern Region,Mulanje,Mulanje,2115,-16.03,35.50,"coffee","Coffee (arabica)",703,KG,actual,Wholesale,MWK,5150,6.28
2021-02-15,Central Region,Dowa,Dowa,2007,-13.65,34.30,"pulses and nuts","Beans (red)",68,KG,actual,Retail,MWK,2520,3.07
2021-02-15,Central Region,Dowa,Dowa,2007,-13.65,34.30,"pulses and nuts","Groundnuts (unshelled)",69,KG,actual,Retail,MWK,1520,1.85
2021-03-15,Central Region,Kasungu,Kasungu,2008,-13.03,33.48,"tobacco","Tobacco (Virginia)",701,KG,actual,Wholesale,MWK,6200,7.56
2021-03-15,Southern Region,Thyolo,Thyolo,2120,-16.07,35.14,"tea","Tea (black)",702,KG,actual,Wholesale,MWK,3040,3.71
2021-03-15,Southern Region,Mulanje,Mulanje,2115,-16.03,35.50,"coffee","Coffee (arabica)",703,KG,actual,Wholesale,MWK,5200,6.34
2021-03-15,Central Region,Dowa,Dowa,2007,-13.65,34.30,"pulses and nuts","Beans (red)",68,KG,actual,Retail,MWK,2540,3.10
2021-03-15,Central Region,Dowa,Dowa,2007,-13.65,34.30,"pulses and nuts","Groundnuts (unshelled)",69,KG,actual,Retail,MWK,1540,1.88
2022-01-15,Central Region,Kasungu,Kasungu,2008,-13.03,33.48,"tobacco","Tobacco (Virginia)",701,KG,actual,Wholesale,MWK,6500,7.93
2022-01-15,Southern Region,Thyolo,Thyolo,2120,-16.07,35.14,"tea","Tea (black)",702,KG,actual,Wholesale,MWK,3200,3.90
2022-01-15,Southern Region,Mulanje,Mulanje,2115,-16.03,35.50,"coffee","Coffee (arabica)",703,KG,actual,Wholesale,MWK,5400,6.59
2022-01-15,Central Region,Dowa,Dowa,2007,-13.65,34.30,"pulses and nuts","Beans (red)",68,KG,actual,Retail,MWK,2600,3.17
2022-01-15,Central Region,Dowa,Dowa,2007,-13.65,34.30,"pulses and nuts","Groundnuts (unshelled)",69,KG,actual,Retail,MWK,1580,1.93
2023-01-15,Central Region,Kasungu,Kasungu,2008,-13.03,33.48,"tobacco","Tobacco (Virginia)",701,KG,actual,Wholesale,MWK,6800,8.29
2023-01-15,Southern Region,Thyolo,Thyolo,2120,-16.07,35.14,"tea","Tea (black)",702,KG,actual,Wholesale,MWK,3400,4.15
2023-01-15,Southern Region,Mulanje,Mulanje,2115,-16.03,35.50,"coffee","Coffee (arabica)",703,KG,actual,Wholesale,MWK,5600,6.83
2023-01-15,Central Region,Dowa,Dowa,2007,-13.65,34.30,"pulses and nuts","Beans (red)",68,KG,actual,Retail,MWK,2700,3.29
2023-01-15,Central Region,Dowa,Dowa,2007,-13.65,34.30,"pulses and nuts","Groundnuts (unshelled)",69,KG,actual,Retail,MWK,1620,1.98
2024-01-15,Central Region,Kasungu,Kasungu,2008,-13.03,33.48,"tobacco","Tobacco (Virginia)",701,KG,actual,Wholesale,MWK,7000,8.54
2024-01-15,Southern Region,Thyolo,Thyolo,2120,-16.07,35.14,"tea","Tea (black)",702,KG,actual,Wholesale,MWK,3500,4.27
2024-01-15,Southern Region,Mulanje,Mulanje,2115,-16.03,35.50,"coffee","Coffee (arabica)",703,KG,actual,Wholesale,MWK,5800,7.07
2024-01-15,Central Region,Dowa,Dowa,2007,-13.65,34.30,"pulses and nuts","Beans (red)",68,KG,actual,Retail,MWK,2800,3.41
2024-01-15,Central Region,Dowa,Dowa,2007,-13.65,34.30,"pulses and nuts","Groundnuts (unshelled)",69,KG,actual,Retail,MWK,1680,2.05
2025-01-15,Central Region,Kasungu,Kasungu,2008,-13.03,33.48,"tobacco","Tobacco (Virginia)",701,KG,actual,Wholesale,MWK,7200,8.78
2025-01-15,Central Region,Kasungu,Kasungu,2008,-13.03,33.48,"tobacco","Tobacco (Burley)",702,KG,actual,Wholesale,MWK,6900,8.41
2025-01-15,Central Region,Mchinji,Mchinji,2010,-13.80,32.90,"tobacco","Tobacco (Oriental)",703,KG,actual,Wholesale,MWK,6300,7.68
2025-01-15,Southern Region,Thyolo,Thyolo,2120,-16.07,35.14,"tea","Tea (black)",702,KG,actual,Wholesale,MWK,3600,4.39
2025-01-15,Southern Region,Thyolo,Thyolo,2120,-16.07,35.14,"tea","Tea (green)",704,KG,actual,Wholesale,MWK,3800,4.63
2025-01-15,Southern Region,Mulanje,Mulanje,2115,-16.03,35.50,"coffee","Coffee (arabica)",703,KG,actual,Wholesale,MWK,6000,7.32
2025-01-15,Southern Region,Mulanje,Mulanje,2115,-16.03,35.50,"coffee","Coffee (robusta)",705,KG,actual,Wholesale,MWK,4800,5.85
2025-01-15,Central Region,Dowa,Dowa,2007,-13.65,34.30,"pulses and nuts","Beans (red)",68,KG,actual,Retail,MWK,2900,3.54
2025-01-15,Central Region,Dowa,Dowa,2007,-13.65,34.30,"pulses and nuts","Beans (brown)",706,KG,actual,Retail,MWK,2850,3.48
2025-01-15,Central Region,Dowa,Dowa,2007,-13.65,34.30,"pulses and nuts","Beans (white)",707,KG,actual,Retail,MWK,3000,3.66
2025-01-15,Central Region,Dowa,Dowa,2007,-13.65,34.30,"pulses and nuts","Groundnuts (unshelled)",69,KG,actual,Retail,MWK,1700,2.07
2025-01-15,Central Region,Dowa,Dowa,2007,-13.65,34.30,"pulses and nuts","Groundnuts (red skin)",708,KG,actual,Retail,MWK,1750,2.13
2025-01-15,Central Region,Dowa,Dowa,2007,-13.65,34.30,"pulses and nuts","Groundnuts (spanish)",709,KG,actual,Retail,MWK,1650,2.01
2025-01-15,Central Region,Dowa,Dowa,2007,-13.65,34.30,"pulses and nuts","Groundnuts (virginia)",710,KG,actual,Retail,MWK,1800,2.20
2025-11-15,Central Region,Dowa,Dowa,2007,-13.65,34.30,"cereals and tubers","Maize (white)",67,KG,actual,Retail,MWK,1400,0.81
2025-11-15,Central Region,Dowa,Dowa,2007,-13.65,34.30,"cereals and tubers","Rice (imported)",64,KG,actual,Retail,MWK,2100,1.21
2025-11-15,Central Region,Dowa,Dowa,2007,-13.65,34.30,"cereals and tubers","Sorghum (red)",282,KG,actual,Retail,MWK,1540,0.89
2025-11-15,Central Region,Kasungu,Kasungu,2008,-13.03,33.48,"tobacco","Tobacco (Virginia)",701,KG,actual,Wholesale,MWK,6600,3.81
2025-11-15,Southern Region,Thyolo,Thyolo,2120,-16.07,35.14,"tea","Tea (black)",702,KG,actual,Wholesale,MWK,3300,1.90
2025-11-15,Southern Region,Mulanje,Mulanje,2115,-16.03,35.50,"coffee","Coffee (arabica)",703,KG,actual,Wholesale,MWK,5500,3.17
2025-11-15,Central Region,Dowa,Dowa,2007,-13.65,34.30,"pulses and nuts","Beans (red)",68,KG,actual,Retail,MWK,2750,1.59
2025-11-15,Central Region,Dowa,Dowa,2007,-13.65,34.30,"pulses and nuts","Groundnuts (unshelled)",69,KG,actual,Retail,MWK,1650,0.95
"""

# Save embedded CSV to cache if not exists
EMBEDDED_CSV_PATH = os.path.join(CACHE_DIR, "embedded_wfp_food_prices_mwi.csv")
if not os.path.exists(EMBEDDED_CSV_PATH):
    with open(EMBEDDED_CSV_PATH, 'w', encoding='utf-8') as f:
        f.write(EMBEDDED_CSV_DATA.strip() + "\n")
    logging.info(f"Embedded CSV saved to {EMBEDDED_CSV_PATH}")